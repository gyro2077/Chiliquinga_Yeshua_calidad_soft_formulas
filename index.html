<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Gesti√≥n de Calidad - Yeshua Chiliquinga</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <!-- jsPDF para generaci√≥n de PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      background-color: #f8fafc;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f5f9;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }

    /* Sidebar Animations */
    .sidebar-link {
      position: relative;
      overflow: hidden;
    }

    .sidebar-link::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: #6366f1;
      /* Indigo-500 */
      transform: scaleY(0);
      transition: transform 0.3s ease;
    }

    .sidebar-link.active::before {
      transform: scaleY(1);
    }

    .sidebar-link.active {
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
    }

    /* Card Effects */
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .input-group:focus-within label {
      color: #4f46e5;
    }

    .input-group:focus-within input {
      border-color: #4f46e5;
      ring: 2px solid #4f46e5;
    }

    /* Error Animation */
    .shake {
      animation: shake 0.82s cubic-bezier(.36, .07, .19, .97) both;
    }

    @keyframes shake {

      10%,
      90% {
        transform: translate3d(-1px, 0, 0);
      }

      20%,
      80% {
        transform: translate3d(2px, 0, 0);
      }

      30%,
      50%,
      70% {
        transform: translate3d(-4px, 0, 0);
      }

      40%,
      60% {
        transform: translate3d(4px, 0, 0);
      }
    }

    /* Tooltip Styles - Mejorado para evitar overflow */
    .tooltip {
      position: relative;
      display: inline-block;
      cursor: help;
    }

    .tooltip .tooltiptext {
      visibility: hidden;
      width: 280px;
      max-width: 90vw;
      background-color: #1e293b;
      color: #fff;
      text-align: left;
      border-radius: 8px;
      padding: 12px;
      position: fixed;
      z-index: 10000;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      line-height: 1.5;
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
      pointer-events: none;
    }

    .tooltip .tooltiptext::after {
      content: "";
      position: absolute;
      border-width: 6px;
      border-style: solid;
    }
    
    /* Tooltip arriba (por defecto) */
    .tooltip .tooltiptext[data-position="top"]::after {
      top: 100%;
      left: 50%;
      margin-left: -6px;
      border-color: #1e293b transparent transparent transparent;
    }
    
    /* Tooltip abajo */
    .tooltip .tooltiptext[data-position="bottom"]::after {
      bottom: 100%;
      left: 50%;
      margin-left: -6px;
      border-color: transparent transparent #1e293b transparent;
    }
    
    /* Tooltip izquierda */
    .tooltip .tooltiptext[data-position="left"]::after {
      left: 100%;
      top: 50%;
      margin-top: -6px;
      border-color: transparent transparent transparent #1e293b;
    }
    
    /* Tooltip derecha */
    .tooltip .tooltiptext[data-position="right"]::after {
      right: 100%;
      top: 50%;
      margin-top: -6px;
      border-color: transparent #1e293b transparent transparent;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }

    /* Step indicator */
    .step-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
    }

    .step-number {
      background: #6366f1;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
    }

    /* Info boxes */
    .info-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 20px;
      font-size: 14px;
      line-height: 1.6;
    }

    .info-box-blue {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .info-box-green {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }

    .info-box-yellow {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }

    /* Pulse animation for help icons */
    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    .help-icon {
      animation: pulse 2s infinite;
    }

    /* Scroll bar in event log */
    #event-log::-webkit-scrollbar {
      width: 4px;
    }

    #event-log::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.3);
    }

    #event-log::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.5);
      border-radius: 2px;
    }

    #event-log::-webkit-scrollbar-thumb:hover {
      background: rgba(148, 163, 184, 0.7);
    }
  </style>
</head>

<body class="flex h-screen overflow-hidden text-slate-800">

  <!-- Sidebar -->
  <aside class="w-72 bg-slate-900 text-slate-100 flex flex-col shadow-2xl z-20 transition-all">
    <!-- Profile / Header Section -->
    <div class="p-6 border-b border-slate-700 bg-slate-800">
      <div class="flex items-center gap-3 mb-4">
        <div
          class="w-10 h-10 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg shadow-lg">
          YC
        </div>
        <div>
          <h2 class="text-white font-bold text-sm leading-tight">Yeshua Chiliquinga</h2>
          <p class="text-xs text-indigo-400">Estudiante</p>
        </div>
      </div>
      <div class="bg-slate-900/50 p-3 rounded-lg border border-slate-700">
        <p class="text-[10px] uppercase tracking-wider text-slate-400 font-bold mb-1">Materia</p>
        <p class="text-xs text-slate-100 font-medium">27888 Aseguramiento de la Calidad de Software</p>
      </div>
      
      <!-- Nombre del Proyecto -->
      <div class="bg-gradient-to-r from-indigo-500/10 to-purple-500/10 p-4 rounded-lg border border-indigo-500/30 mt-4">
        <label class="block text-xs font-bold text-slate-300 mb-2">
          <i class="fas fa-folder-open mr-2"></i>Nombre del Proyecto
        </label>
        <input type="text" id="projectName" 
          class="w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-sm text-slate-100 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
          placeholder="Ej: Sistema de Gesti√≥n v2.0"
          value="Mi Proyecto de Calidad">
      </div>
      <a href="https://chiliquinga-yeshua-calidad-soft-formulas.onrender.com" target="_blank" 
         class="mt-3 flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 p-2.5 rounded-lg transition-all group">
        <i class="fas fa-external-link-alt text-xs group-hover:scale-110 transition-transform"></i>
        <span class="text-xs font-medium">Ver p√°gina publicada</span>
      </a>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 overflow-y-auto py-6 space-y-1">
      <a href="#" onclick="showSection('dashboard')" id="nav-dashboard"
        class="sidebar-link active flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <i class="fas fa-chart-pie w-6 group-hover:text-indigo-400 transition-colors"></i>
        <span class="font-medium">Dashboard General</span>
      </a>

      <div class="px-6 py-4 mt-2 text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2">
        <i class="fas fa-cogs"></i>
        Calidad de Proceso
      </div>

      <a href="#" onclick="showSection('iso29110')" id="nav-iso29110"
        class="sidebar-link flex items-center justify-between px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <div class="flex items-center gap-3">
          <i class="fas fa-tasks group-hover:text-blue-400 transition-colors"></i>
          <div>
            <span class="block font-medium">ISO 29110 (ICP)</span>
            <span class="text-[10px] text-slate-400 group-hover:text-slate-300">Cumplimiento de actividades</span>
          </div>
        </div>
      </a>
      <a href="#" onclick="showSection('iso9001')" id="nav-iso9001"
        class="sidebar-link flex items-center justify-between px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <div class="flex items-center gap-3">
          <i class="fas fa-file-contract group-hover:text-yellow-400 transition-colors"></i>
          <div>
            <span class="block font-medium">ISO 9001 (NC)</span>
            <span class="text-[10px] text-slate-400 group-hover:text-slate-300">No conformidades</span>
          </div>
        </div>
      </a>

      <div class="px-6 py-4 mt-2 text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2">
        <i class="fas fa-box"></i>
        Calidad de Producto
      </div>

      <a href="#" onclick="showSection('reliability')" id="nav-reliability"
        class="sidebar-link flex items-center justify-between px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <div class="flex items-center gap-3">
          <i class="fas fa-server group-hover:text-red-400 transition-colors"></i>
          <div>
            <span class="block font-medium">Fiabilidad (MTBF)</span>
            <span class="text-[10px] text-slate-400 group-hover:text-slate-300">Tiempo entre fallos</span>
          </div>
        </div>
      </a>
      <a href="#" onclick="showSection('performance')" id="nav-performance"
        class="sidebar-link flex items-center justify-between px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <div class="flex items-center gap-3">
          <i class="fas fa-tachometer-alt group-hover:text-green-400 transition-colors"></i>
          <div>
            <span class="block font-medium">Rendimiento (TPR)</span>
            <span class="text-[10px] text-slate-400 group-hover:text-slate-300">Velocidad de respuesta</span>
          </div>
        </div>
      </a>
      <a href="#" onclick="showSection('structure')" id="nav-structure"
        class="sidebar-link flex items-center justify-between px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <div class="flex items-center gap-3">
          <i class="fas fa-code-branch group-hover:text-purple-400 transition-colors"></i>
          <div>
            <span class="block font-medium">Estructural (CISQ)</span>
            <span class="text-[10px] text-slate-400 group-hover:text-slate-300">Complejidad & Seguridad</span>
          </div>
        </div>
      </a>
      <a href="#" onclick="showSection('usability')" id="nav-usability"
        class="sidebar-link flex items-center justify-between px-6 py-3 hover:bg-slate-800 hover:text-white transition-all group">
        <div class="flex items-center gap-3">
          <i class="fas fa-users group-hover:text-teal-400 transition-colors"></i>
          <div>
            <span class="block font-medium">Usabilidad (UX)</span>
            <span class="text-[10px] text-slate-400 group-hover:text-slate-300">Experiencia de usuario</span>
          </div>
        </div>
      </a>
    </nav>

    <div class="p-4 border-t border-slate-700 text-center text-xs text-slate-500">
      &copy; 2024 Sistema Integrado
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 overflow-y-auto bg-slate-50 p-8 relative">
    <!-- Background decoration -->
    <div class="absolute top-0 left-0 w-full h-64 bg-gradient-to-r from-indigo-600 to-purple-700 -z-10"></div>

    <!-- Header Title (Dynamic) -->
    <div class="mb-8">
      <div class="flex justify-between items-start mb-3">
        <div class="flex-1">
          <h1 class="text-4xl font-bold mb-2 text-slate-900" id="page-title">Panel de Control</h1>
          <p class="text-slate-800 text-base drop-shadow-lg" id="page-subtitle">Sistema de gesti√≥n y monitorizaci√≥n de m√©tricas de calidad de software</p>
        </div>
        <!-- Indicador de Progreso -->
        <div class="bg-white/20 backdrop-blur-md rounded-xl p-4 min-w-[180px] border border-white/30">
          <div class="flex items-center gap-2 mb-2">
            <i class="fas fa-tasks text-slate-900"></i>
            <span class="text-sm font-bold text-slate-900">Progreso</span>
          </div>
          <div class="text-3xl font-bold mb-1 text-slate-900"><span id="progressCount">0</span>/7</div>
          <div class="w-full bg-slate-300 rounded-full h-2 mb-2">
            <div id="progressBar" class="bg-slate-900 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
          </div>
          <p class="text-xs opacity-90 text-slate-800">m√©tricas calculadas</p>
        </div>
      </div>
      
      <!-- Gu√≠a de Uso Completa -->
      <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-5">
        <div class="flex items-start gap-4 mb-4">
          <div class="bg-blue-500 rounded-full p-3 text-white">
            <i class="fas fa-map-marked-alt text-2xl"></i>
          </div>
          <div class="flex-1">
            <h3 class="text-xl font-bold text-slate-900 mb-3">
              <i class="fas fa-compass mr-2"></i>Gu√≠a de Uso del Sistema
            </h3>
            <p class="text-slate-800 text-sm mb-4 opacity-90">Sigue estos 4 pasos para obtener un reporte completo de calidad</p>
          </div>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-3">
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/20">
            <h4 class="font-bold text-slate-900 mb-2 flex items-center gap-2">
              <span class="bg-indigo-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">1</span>
              Preparaci√≥n
            </h4>
            <ul class="text-xs text-slate-800 space-y-1">
              <li>‚úì Nombre del proyecto (sidebar)</li>
              <li>‚úì Revisar esta gu√≠a</li>
            </ul>
          </div>
          
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/20">
            <h4 class="font-bold text-slate-900 mb-2 flex items-center gap-2">
              <span class="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">2</span>
              C√°lculos
            </h4>
            <ul class="text-xs text-slate-800 space-y-1">
              <li>‚Üí Usa men√∫ lateral</li>
              <li>‚Üí Calcula cada m√©trica</li>
              <li>‚Üí Observa progreso (X/7)</li>
            </ul>
          </div>
          
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/20">
            <h4 class="font-bold text-slate-900 mb-2 flex items-center gap-2">
              <span class="bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">3</span>
              Revisi√≥n
            </h4>
            <ul class="text-xs text-slate-800 space-y-1">
              <li>üëÅ Regresa al Dashboard</li>
              <li>üëÅ Revisa tarjetas</li>
              <li>üëÅ Analiza gr√°fico radar</li>
            </ul>
          </div>
          
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/20">
            <h4 class="font-bold text-slate-900 mb-2 flex items-center gap-2">
              <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">4</span>
              Exportaci√≥n
            </h4>
            <ul class="text-xs text-slate-800 space-y-1">
              <li>üìÑ Genera reporte PDF</li>
              <li>‚¨á Descarga documento</li>
              <li>üì§ Comparte con equipo</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Dashboard Section -->
    <section id="dashboard" class="content-section space-y-8">
      <!-- KPI Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Card 1 -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-blue-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('iso29110')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                Cumplimiento ISO 29110
                <div class="tooltip">
                  <i class="fas fa-info-circle text-blue-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    Mide qu√© % de actividades planeadas fueron completadas. Indica disciplina del equipo.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-icp">--%</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-blue-50 text-blue-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-check-circle text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-blue-600 font-semibold">Proceso:</span> Gesti√≥n de Proyectos
          </div>
          <div class="mt-2 text-xs text-blue-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>

        <!-- Card 2 -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-red-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('reliability')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                Fiabilidad (MTBF)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-red-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    Tiempo medio entre fallos. Indica estabilidad y confiabilidad del sistema.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-mtbf">-- h</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-red-50 text-red-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-heartbeat text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-red-600 font-semibold">Cr√≠tico:</span> Disponibilidad del sistema
          </div>
          <div class="mt-2 text-xs text-red-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>

        <!-- Card 3 -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-green-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('performance')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                Rendimiento (TPR)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-green-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    Tiempo promedio de respuesta. Mide la velocidad de tu aplicaci√≥n.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-tpr">-- ms</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-green-50 text-green-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-stopwatch text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-green-600 font-semibold">KPI:</span> < 200ms
          </div>
          <div class="mt-2 text-xs text-green-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>

        <!-- Card 4 -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-purple-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('structure')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                Complejidad (CC)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-purple-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    Complejidad ciclom√°tica de McCabe. Indica qu√© tan dif√≠cil es mantener el c√≥digo.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-cc">--</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-purple-50 text-purple-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-code text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-purple-600 font-semibold">McCabe:</span> Mantenibilidad
          </div>
          <div class="mt-2 text-xs text-purple-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>
        
        <!-- Card 5 - ISO 9001 NC -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-yellow-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('iso9001')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                No Conformidades (NC)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-yellow-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    √çndice de no conformidades. Mide problemas en auditor√≠as ISO 9001.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-nc">--</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-yellow-50 text-yellow-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-clipboard-check text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-yellow-600 font-semibold">ISO 9001:</span> Gesti√≥n de Calidad
          </div>
          <div class="mt-2 text-xs text-yellow-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>
        
        <!-- Card 6 - IVC -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-orange-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('structure')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                Vulnerabilidades (IVC)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-orange-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    √çndice de vulnerabilidades cr√≠ticas en el c√≥digo.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-ivc">--%</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-orange-50 text-orange-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-shield-alt text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-orange-600 font-semibold">Seguridad:</span> Vulnerabilidades
          </div>
          <div class="mt-2 text-xs text-orange-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>
        
        <!-- Card 7 - UX -->
        <div
          class="bg-white rounded-2xl p-6 shadow-lg border-b-4 border-teal-500 hover:-translate-y-1 transition-transform duration-300 cursor-pointer group"
          onclick="showSection('usability')">
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase flex items-center gap-1">
                Usabilidad (UX)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-teal-300 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px;">
                    Tasa de √©xito en tareas de usuario. Mide facilidad de uso.
                  </span>
                </div>
              </p>
              <h3 class="text-3xl font-bold text-slate-700 mt-1" id="dash-ux">--%</h3>
            </div>
            <div class="w-10 h-10 rounded-lg bg-teal-50 text-teal-500 flex items-center justify-center group-hover:scale-110 transition-transform">
              <i class="fas fa-smile text-xl"></i>
            </div>
          </div>
          <div class="text-xs text-slate-500">
            <span class="text-teal-600 font-semibold">ISO 9241:</span> Experiencia Usuario
          </div>
          <div class="mt-2 text-xs text-teal-500 font-semibold opacity-0 group-hover:opacity-100 transition-opacity">
            <i class="fas fa-arrow-right mr-1"></i>Click para calcular
          </div>
        </div>
      </div>

        <!-- Charts & Actions -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <div class="lg:col-span-2 bg-white rounded-2xl shadow-lg p-6">
            <h3 class="font-bold text-slate-700 mb-6 flex items-center">
              <i class="fas fa-radar text-indigo-500 mr-2"></i>Radar de Calidad Integral
            </h3>
            <div class="h-64 flex justify-center">
              <canvas id="qualityChart"></canvas>
            </div>
          </div>

          <div
            class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl shadow-lg p-6 text-white flex flex-col justify-between">
            <div>
              <h3 class="font-bold text-lg mb-2 text-white">Registro de Eventos</h3>
              <p class="text-slate-300 text-sm mb-4">Historial de actividades y m√©tricas calculadas.</p>

              <!-- Event Log -->
              <div id="event-log" class="bg-slate-900/50 rounded-lg p-3 mb-4 max-h-48 overflow-y-auto">
                <p class="text-xs text-slate-400 text-center py-4">No hay eventos registrados a√∫n</p>
              </div>

              <div class="space-y-2">
                <button
                  class="w-full bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white p-3 rounded-lg flex items-center transition-all group text-sm shadow-lg hover:shadow-xl"
                  onclick="generatePDFReport()">
                  <div
                    class="bg-white/20 text-white w-8 h-8 rounded-lg flex items-center justify-center mr-2 group-hover:scale-110 transition-transform">
                    <i class="fas fa-file-pdf text-sm"></i>
                  </div>
                  <span class="font-bold">Generar Reporte PDF</span>
                </button>
                
                <button
                  class="w-full bg-green-500/20 hover:bg-green-500/40 border border-green-500/50 text-green-100 p-2 rounded-lg flex items-center transition-all group text-xs"
                  onclick="exportToCSV()">
                  <div
                    class="bg-green-500 text-white w-6 h-6 rounded-lg flex items-center justify-center mr-2 group-hover:scale-110 transition-transform">
                    <i class="fas fa-file-csv text-[10px]"></i>
                  </div>
                  <span class="font-semibold text-white">CSV (alternativo)</span>
                </button>

                <button
                  class="w-full bg-purple-500/20 hover:bg-purple-500/40 border border-purple-500/50 text-purple-100 p-2.5 rounded-lg flex items-center transition-all group text-sm"
                  onclick="clearEventLog()">
                  <div
                    class="bg-purple-500 text-white w-7 h-7 rounded-lg flex items-center justify-center mr-2 group-hover:scale-110 transition-transform">
                    <i class="fas fa-trash-alt text-xs"></i>
                  </div>
                  <span class="font-semibold text-white">Limpiar Historial</span>
                </button>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-slate-700 text-center">
              <p class="text-xs text-slate-400">Sistema v2.0 - Developed by Yeshua C.</p>
            </div>
          </div>
        </div>
    </section>

    <!-- Template for Calculator Sections -->

    <!-- ISO 29110 -->
    <section id="iso29110" class="content-section hidden space-y-6">
      <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100">
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center">
            <div class="bg-blue-100 p-3 rounded-full text-blue-600 mr-4"><i class="fas fa-tasks text-xl"></i></div>
            <div>
              <h2 class="text-xl font-bold text-slate-800">C√°lculo de ICP (ISO 29110)</h2>
              <p class="text-slate-500 text-sm">√çndice de Cumplimiento de Procesos para Microempresas (VSE)</p>
            </div>
          </div>
          <div class="tooltip">
            <i class="fas fa-question-circle text-2xl text-blue-400 help-icon"></i>
            <span class="tooltiptext">
              <strong>¬øQu√© es ISO 29110?</strong><br>
              Es un est√°ndar internacional dise√±ado para peque√±as empresas que desarrollan software. Ayuda a establecer procesos organizados y medibles.
            </span>
          </div>
        </div>

        <!-- Info Box Explicativa -->
        <div class="info-box info-box-blue">
          <div class="flex items-start gap-3">
            <i class="fas fa-lightbulb text-2xl mt-1"></i>
            <div>
              <strong class="block mb-1">¬øQu√© mide este indicador?</strong>
              El ICP te dice qu√© tan bien est√°s cumpliendo con las actividades que planificaste para tu proyecto. 
              Un resultado alto significa que tu equipo es disciplinado y cumple lo prometido.
            </div>
          </div>
        </div>

        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded-r-lg">
          <div class="text-sm text-blue-900 overflow-x-auto">
            $$ICP = \frac{\text{Actividades Realizadas}}{\text{Actividades Planificadas}} \times 100$$
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="space-y-5">
            <!-- Paso 1 -->
            <div class="step-indicator">
              <div class="step-number">1</div>
              <span class="text-sm font-semibold text-slate-700">Ingresa las actividades planificadas</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Actividades Planificadas
                <div class="tooltip">
                  <i class="fas fa-info-circle text-blue-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero total de tareas que planeaste hacer en el proyecto. Ejemplo: si tu plan tiene 15 reuniones, entregas y revisiones, ingresa "15".
                  </span>
                </div>
              </label>
              <input type="number" id="icp-planned" min="1"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all placeholder-slate-400 text-slate-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"
                placeholder="Ej: 15">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-arrow-right mr-1"></i>Ejemplo: 15 actividades en tu cronograma</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <!-- Paso 2 -->
            <div class="step-indicator">
              <div class="step-number">2</div>
              <span class="text-sm font-semibold text-slate-700">Ingresa las actividades completadas</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Actividades Realizadas
                <div class="tooltip">
                  <i class="fas fa-info-circle text-blue-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero de tareas que efectivamente completaste. Si completaste 13 de las 15 tareas planeadas, ingresa "13".
                  </span>
                </div>
              </label>
              <input type="number" id="icp-realized" min="0"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all placeholder-slate-400 text-slate-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"
                placeholder="Ej: 13">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-arrow-right mr-1"></i>Ejemplo: 13 actividades completadas exitosamente</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <!-- Paso 3 -->
            <div class="step-indicator">
              <div class="step-number">3</div>
              <span class="text-sm font-semibold text-slate-700">Obt√©n tu resultado</span>
            </div>
            <button onclick="calcICP()"
              class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2">
              <i class="fas fa-calculator"></i>
              Calcular Cumplimiento
            </button>
          </div>

          <!-- Result Panel -->
          <div id="icp-result"
            class="hidden bg-gradient-to-br from-slate-50 to-blue-50 rounded-xl p-8 border-2 border-blue-200 flex flex-col justify-center items-center text-center relative overflow-hidden shadow-lg">
            <div class="absolute top-0 left-0 w-2 h-full bg-gray-300" id="icp-bar"></div>
            <i class="fas fa-chart-line text-4xl text-blue-500 mb-3"></i>
            <span class="text-slate-500 text-sm uppercase tracking-wider font-semibold">Tu √çndice de Cumplimiento</span>
            <span class="text-6xl font-extrabold text-slate-800 my-4" id="icp-value">0%</span>
            <span id="icp-badge" class="px-6 py-2 rounded-full text-sm font-bold bg-gray-200 text-gray-700 shadow-md">--</span>
            <p id="icp-feedback" class="text-sm mt-5 text-slate-700 max-w-xs leading-relaxed"></p>
            
            <!-- Interpretaci√≥n -->
            <div class="mt-6 pt-6 border-t border-slate-300 w-full">
              <p class="text-xs font-bold text-slate-600 uppercase mb-2">üìä C√≥mo interpretar:</p>
              <div class="text-xs text-left space-y-1 text-slate-600">
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                  <span><strong>85-100%:</strong> Excelente disciplina de proyecto</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                  <span><strong>70-84%:</strong> Cumplimiento aceptable, hay margen de mejora</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                  <span><strong>< 70%:</strong> Proceso indisciplinado, requiere atenci√≥n</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ISO 9001 -->
    <section id="iso9001" class="content-section hidden space-y-6">
      <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100">
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center">
            <div class="bg-yellow-100 p-3 rounded-full text-yellow-600 mr-4"><i class="fas fa-file-contract text-xl"></i></div>
            <div>
              <h2 class="text-xl font-bold text-slate-800">No Conformidades (ISO 9001)</h2>
              <p class="text-slate-500 text-sm">Evaluaci√≥n de salud del sistema de gesti√≥n</p>
            </div>
          </div>
          <div class="tooltip">
            <i class="fas fa-question-circle text-2xl text-yellow-400 help-icon"></i>
            <span class="tooltiptext">
              <strong>¬øQu√© es ISO 9001?</strong><br>
              Es un est√°ndar de gesti√≥n de calidad. Las "no conformidades" son problemas encontrados durante auditor√≠as que indican que algo no se est√° haciendo seg√∫n lo especificado.
            </span>
          </div>
        </div>

        <!-- Info Box -->
        <div class="info-box info-box-yellow">
          <div class="flex items-start gap-3">
            <i class="fas fa-exclamation-triangle text-2xl mt-1"></i>
            <div>
              <strong class="block mb-1">¬øQu√© significa este indicador?</strong>
              Mide cu√°ntos problemas o incumplimientos se encontraron en relaci√≥n con los procesos revisados. 
              Un n√∫mero bajo es mejor: significa que tu sistema de gesti√≥n est√° funcionando correctamente.
            </div>
          </div>
        </div>

        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6 rounded-r-lg">
          <div class="text-sm text-yellow-900 overflow-x-auto">
            $$NC = \frac{\text{No Conformidades Encontradas}}{\text{Total Procesos Auditados}}$$
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="space-y-5">
            <div class="step-indicator">
              <div class="step-number">1</div>
              <span class="text-sm font-semibold text-slate-700">Define cu√°ntos procesos revisaste</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Total Procesos Auditados
                <div class="tooltip">
                  <i class="fas fa-info-circle text-yellow-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero de procesos o √°reas que fueron revisadas en la auditor√≠a. Ejemplo: si auditaste "Compras", "Ventas", "Producci√≥n" y "RRHH", ser√≠an 4 procesos.
                  </span>
                </div>
              </label>
              <input type="number" id="nc-total" min="1"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all focus:border-yellow-500 focus:ring-2 focus:ring-yellow-200"
                placeholder="Ej: 4">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-arrow-right mr-1"></i>Cantidad de √°reas o procesos revisados</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <div class="step-indicator">
              <div class="step-number">2</div>
              <span class="text-sm font-semibold text-slate-700">Ingresa los problemas encontrados</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Hallazgos (No Conformidades)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-yellow-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero de problemas o incumplimientos detectados. Ejemplo: si encontraste 1 procedimiento sin documentar, ingresa "1".
                  </span>
                </div>
              </label>
              <input type="number" id="nc-found" min="0"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all focus:border-yellow-500 focus:ring-2 focus:ring-yellow-200"
                placeholder="Ej: 1">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-arrow-right mr-1"></i>N√∫mero de incumplimientos detectados</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <div class="step-indicator">
              <div class="step-number">3</div>
              <span class="text-sm font-semibold text-slate-700">Eval√∫a el nivel de riesgo</span>
            </div>
            <button onclick="calcNC()"
              class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
              <i class="fas fa-search"></i>
              Calcular Riesgo
            </button>
          </div>

          <div id="nc-result"
            class="hidden bg-gradient-to-br from-slate-50 to-yellow-50 rounded-xl p-8 border-2 border-yellow-200 flex flex-col justify-center items-center text-center relative shadow-lg">
            <div class="absolute top-0 left-0 w-2 h-full bg-gray-300" id="nc-bar"></div>
            <i class="fas fa-clipboard-check text-4xl text-yellow-500 mb-3"></i>
            <span class="text-slate-500 text-sm uppercase font-semibold">√çndice de No Conformidades</span>
            <span class="text-6xl font-extrabold text-slate-800 my-4" id="nc-value">0</span>
            <span id="nc-badge" class="px-6 py-2 rounded-full text-sm font-bold bg-gray-200 text-gray-700 shadow-md">--</span>
            
            <div class="mt-6 pt-6 border-t border-slate-300 w-full">
              <p class="text-xs font-bold text-slate-600 uppercase mb-2">üìä Interpretaci√≥n:</p>
              <div class="text-xs text-left space-y-1 text-slate-600">
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                  <span><strong>0:</strong> Sistema perfecto, sin hallazgos</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                  <span><strong>0.01-0.25:</strong> Pocos problemas, gestionables</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                  <span><strong>> 0.25:</strong> Sistema fallido, necesita revisi√≥n urgente</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- MTBF -->
    <section id="reliability" class="content-section hidden space-y-6">
      <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100">
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center">
            <div class="bg-red-100 p-3 rounded-full text-red-600 mr-4"><i class="fas fa-server text-xl"></i></div>
            <div>
              <h2 class="text-xl font-bold text-slate-800">Fiabilidad: MTBF (ISO 25010)</h2>
              <p class="text-slate-500 text-sm">Tiempo Medio Entre Fallos</p>
            </div>
          </div>
          <div class="tooltip">
            <i class="fas fa-question-circle text-2xl text-red-400 help-icon"></i>
            <span class="tooltiptext">
              <strong>¬øQu√© es MTBF?</strong><br>
              Mean Time Between Failures (Tiempo Medio Entre Fallos). Mide qu√© tan confiable es tu sistema calculando cu√°nto tiempo pasa en promedio entre cada fallo.
            </span>
          </div>
        </div>

        <!-- Info Box -->
        <div class="info-box" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
          <div class="flex items-start gap-3">
            <i class="fas fa-heartbeat text-2xl mt-1"></i>
            <div>
              <strong class="block mb-1">¬øPor qu√© es importante?</strong>
              El MTBF te indica la estabilidad de tu sistema. Un valor alto significa que tu aplicaci√≥n funciona durante mucho tiempo sin fallar. 
              Ejemplo: si tu app funciona 168 horas (1 semana) y tuvo 8 fallos, el MTBF es 21 horas.
            </div>
          </div>
        </div>

        <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r-lg">
          <div class="text-sm text-red-900 overflow-x-auto">
            $$MTBF = \frac{\text{Tiempo Total Operaci√≥n}}{\text{N√∫mero de Fallos}}$$
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="space-y-5">
            <div class="step-indicator">
              <div class="step-number">1</div>
              <span class="text-sm font-semibold text-slate-700">Registra el tiempo total que estuvo activo</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Tiempo de Operaci√≥n (Horas)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-red-400 text-xs"></i>
                  <span class="tooltiptext">
                    Total de horas que tu sistema estuvo funcionando. Ejemplo: si monitoreaste durante 1 semana completa, son 168 horas (7 d√≠as √ó 24 horas).
                  </span>
                </div>
              </label>
              <input type="number" id="mtbf-time" min="1"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all focus:border-red-500 focus:ring-2 focus:ring-red-200"
                placeholder="Ej: 168 (1 semana)">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-clock mr-1"></i>1 d√≠a = 24h, 1 semana = 168h, 1 mes ‚âà 720h</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <div class="step-indicator">
              <div class="step-number">2</div>
              <span class="text-sm font-semibold text-slate-700">Cuenta cu√°ntas veces fall√≥</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                N√∫mero de Fallos
                <div class="tooltip">
                  <i class="fas fa-info-circle text-red-400 text-xs"></i>
                  <span class="tooltiptext">
                    Cantidad de veces que tu sistema tuvo errores, ca√≠das o comportamientos inesperados durante el per√≠odo medido. Incluye crashes, excepciones cr√≠ticas, etc.
                  </span>
                </div>
              </label>
              <input type="number" id="mtbf-fails" min="0"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all focus:border-red-500 focus:ring-2 focus:ring-red-200"
                placeholder="Ej: 8">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-bug mr-1"></i>Cuenta crashes, errores cr√≠ticos y ca√≠das del sistema</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <div class="step-indicator">
              <div class="step-number">3</div>
              <span class="text-sm font-semibold text-slate-700">Eval√∫a la estabilidad</span>
            </div>
            <button onclick="calcMTBF()"
              class="w-full bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
              <i class="fas fa-heartbeat"></i>
              Calcular Estabilidad
            </button>
          </div>

          <div id="mtbf-result"
            class="hidden bg-gradient-to-br from-slate-50 to-red-50 rounded-xl p-8 border-2 border-red-200 flex flex-col justify-center items-center text-center relative shadow-lg">
            <div class="absolute top-0 left-0 w-2 h-full bg-gray-300" id="mtbf-bar"></div>
            <i class="fas fa-server text-4xl text-red-500 mb-3"></i>
            <span class="text-slate-500 text-sm uppercase font-semibold">Tiempo Promedio Entre Fallos</span>
            <span class="text-6xl font-extrabold text-slate-800 my-4" id="mtbf-value">0h</span>
            <span id="mtbf-badge" class="px-6 py-2 rounded-full text-sm font-bold bg-gray-200 text-gray-700 shadow-md">--</span>
            
            <div class="mt-6 pt-6 border-t border-slate-300 w-full">
              <p class="text-xs font-bold text-slate-600 uppercase mb-2">üìä Rangos de referencia:</p>
              <div class="text-xs text-left space-y-1 text-slate-600">
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                  <span><strong>> 72h:</strong> Sistema muy estable y confiable</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                  <span><strong>24-72h:</strong> Estabilidad moderada, monitorear</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                  <span><strong>< 24h:</strong> Sistema inestable, requiere mejoras urgentes</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TPR -->
    <section id="performance" class="content-section hidden space-y-6">
      <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100">
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center">
            <div class="bg-green-100 p-3 rounded-full text-green-600 mr-4"><i class="fas fa-tachometer-alt text-xl"></i></div>
            <div>
              <h2 class="text-xl font-bold text-slate-800">Rendimiento: TPR</h2>
              <p class="text-slate-500 text-sm">Tiempo Promedio de Respuesta</p>
            </div>
          </div>
          <div class="tooltip">
            <i class="fas fa-question-circle text-2xl text-green-400 help-icon"></i>
            <span class="tooltiptext">
              <strong>¬øQu√© es TPR?</strong><br>
              Tiempo Promedio de Respuesta. Mide qu√© tan r√°pido responde tu aplicaci√≥n a las solicitudes de los usuarios. Es crucial para la experiencia del usuario.
            </span>
          </div>
        </div>

        <!-- Info Box -->
        <div class="info-box info-box-green">
          <div class="flex items-start gap-3">
            <i class="fas fa-rocket text-2xl mt-1"></i>
            <div>
              <strong class="block mb-1">¬øPor qu√© importa la velocidad?</strong>
              Los usuarios abandonan sitios lentos. Un TPR bajo (r√°pido) mejora la experiencia del usuario y la satisfacci√≥n. 
              Est√°ndar: < 200ms es excelente, < 1000ms (1 segundo) es aceptable, > 1s es lento.
            </div>
          </div>
        </div>

        <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded-r-lg">
          <div class="text-sm text-green-900 overflow-x-auto">
            $$TPR = \frac{\sum \text{Tiempos de Respuesta}}{\text{N√∫mero de Solicitudes}}$$
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="space-y-5">
            <div class="step-indicator">
              <div class="step-number">1</div>
              <span class="text-sm font-semibold text-slate-700">Suma todos los tiempos de respuesta</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Tiempo Acumulado (ms)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-green-400 text-xs"></i>
                  <span class="tooltiptext">
                    Suma de todos los tiempos de respuesta medidos. Ejemplo: si mediste 300 solicitudes y la suma total es 5400ms, ingresa "5400". (1 segundo = 1000 milisegundos)
                  </span>
                </div>
              </label>
              <input type="number" id="tpr-total-time" min="1"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all focus:border-green-500 focus:ring-2 focus:ring-green-200"
                placeholder="Ej: 5400">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-stopwatch mr-1"></i>Recuerda: 1000ms = 1 segundo</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <div class="step-indicator">
              <div class="step-number">2</div>
              <span class="text-sm font-semibold text-slate-700">Indica cu√°ntas solicitudes procesaste</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Total Solicitudes
                <div class="tooltip">
                  <i class="fas fa-info-circle text-green-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero total de peticiones o requests que proces√≥ tu sistema durante la medici√≥n. Pueden ser llamadas API, p√°ginas cargadas, consultas a base de datos, etc.
                  </span>
                </div>
              </label>
              <input type="number" id="tpr-requests" min="1"
                class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg outline-none transition-all focus:border-green-500 focus:ring-2 focus:ring-green-200"
                placeholder="Ej: 300">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-exchange-alt mr-1"></i>Cantidad total de requests procesados</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>

            <div class="step-indicator">
              <div class="step-number">3</div>
              <span class="text-sm font-semibold text-slate-700">Calcula el tiempo promedio</span>
            </div>
            <button onclick="calcTPR()"
              class="w-full bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
              <i class="fas fa-tachometer-alt"></i>
              Calcular Latencia
            </button>
          </div>

          <div id="tpr-result"
            class="hidden bg-gradient-to-br from-slate-50 to-green-50 rounded-xl p-8 border-2 border-green-200 flex flex-col justify-center items-center text-center relative shadow-lg">
            <div class="absolute top-0 left-0 w-2 h-full bg-gray-300" id="tpr-bar"></div>
            <i class="fas fa-bolt text-4xl text-green-500 mb-3"></i>
            <span class="text-slate-500 text-sm uppercase font-semibold">Tiempo Promedio de Respuesta</span>
            <span class="text-6xl font-extrabold text-slate-800 my-4" id="tpr-value">0ms</span>
            <span id="tpr-badge" class="px-6 py-2 rounded-full text-sm font-bold bg-gray-200 text-gray-700 shadow-md">--</span>
            
            <div class="mt-6 pt-6 border-t border-slate-300 w-full">
              <p class="text-xs font-bold text-slate-600 uppercase mb-2">‚ö° Est√°ndares de velocidad:</p>
              <div class="text-xs text-left space-y-1 text-slate-600">
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                  <span><strong>< 200ms:</strong> Excelente - Usuario no percibe demora</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                  <span><strong>200-1000ms:</strong> Aceptable - Peque√±a espera perceptible</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                  <span><strong>> 1000ms:</strong> Lento - Frustraci√≥n del usuario</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CISQ -->
    <section id="structure" class="content-section hidden space-y-6">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- McCabe -->
        <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100">
          <div class="flex items-center justify-between mb-4 border-b pb-3">
            <div class="flex items-center gap-3">
              <div class="bg-purple-100 p-2 rounded-lg"><i class="fas fa-code-branch text-purple-600"></i></div>
              <h3 class="text-lg font-bold text-slate-700">Complejidad Ciclom√°tica</h3>
            </div>
            <div class="tooltip">
              <i class="fas fa-question-circle text-purple-400 help-icon"></i>
              <span class="tooltiptext">
                <strong>¬øQu√© es la Complejidad Ciclom√°tica?</strong><br>
                M√©trica de McCabe que mide cu√°ntos caminos independientes hay en tu c√≥digo. M√°s caminos = m√°s complejo = m√°s dif√≠cil de probar y mantener.
              </span>
            </div>
          </div>

          <div class="bg-purple-50 border-l-4 border-purple-500 p-3 mb-4 rounded-r-lg">
            <p class="text-xs text-purple-900 mb-2"><strong>üìö ¬øQu√© necesitas?</strong></p>
            <ul class="text-xs text-purple-800 space-y-1 ml-4">
              <li>‚Ä¢ <strong>E (Aristas):</strong> L√≠neas de conexi√≥n en el grafo</li>
              <li>‚Ä¢ <strong>N (Nodos):</strong> Puntos de decisi√≥n en el c√≥digo</li>
              <li>‚Ä¢ <strong>P (Componentes):</strong> Normalmente 1</li>
            </ul>
          </div>
          
          <div class="mb-4 text-xs bg-slate-100 p-2 rounded font-mono text-slate-600">CC = E - N + 2P</div>

          <div class="grid grid-cols-3 gap-3 mb-4">
            <div class="input-group">
              <label class="text-xs font-bold text-slate-500 flex items-center gap-1">
                Aristas (E)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-purple-400 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px; margin-left: -100px;">
                    L√≠neas que conectan nodos en el grafo de control de flujo. Representa las transiciones entre bloques de c√≥digo.
                  </span>
                </div>
              </label>
              <input type="number" id="cc-edges" class="w-full p-2 border-2 border-slate-300 rounded-md focus:border-purple-500" placeholder="25">
            </div>
            <div class="input-group">
              <label class="text-xs font-bold text-slate-500 flex items-center gap-1">
                Nodos (N)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-purple-400 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px; margin-left: -100px;">
                    Puntos de decisi√≥n en el c√≥digo (if, while, for, switch, etc.). Cada bloque ejecutable cuenta como un nodo.
                  </span>
                </div>
              </label>
              <input type="number" id="cc-nodes" class="w-full p-2 border-2 border-slate-300 rounded-md focus:border-purple-500" placeholder="20">
            </div>
            <div class="input-group">
              <label class="text-xs font-bold text-slate-500 flex items-center gap-1">
                Comp (P)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-purple-400 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 200px; margin-left: -100px;">
                    Componentes conectados. Para una sola funci√≥n/m√©todo, siempre es 1. D√©jalo en 1 por defecto.
                  </span>
                </div>
              </label>
              <input type="number" id="cc-comp" class="w-full p-2 border-2 border-slate-300 rounded-md focus:border-purple-500" value="1">
            </div>
          </div>
          <p class="hidden text-red-500 text-xs mb-3 error-msg" id="cc-error"></p>

          <button onclick="calcCC()"
            class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 rounded-lg transition-colors flex items-center justify-center gap-2">
            <i class="fas fa-calculator"></i>
            Calcular Complejidad
          </button>

          <div id="cc-result" class="hidden mt-4 pt-4 border-t text-center">
            <i class="fas fa-project-diagram text-2xl text-purple-500 mb-2"></i>
            <span class="text-4xl font-bold text-slate-700 block" id="cc-value">0</span>
            <span id="cc-badge" class="inline-block mt-2 px-4 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-bold">--</span>
            <div class="mt-3 text-[10px] text-slate-500 space-y-1">
              <div class="flex items-center justify-center gap-2">
                <span class="w-2 h-2 bg-green-500 rounded-full"></span><span>1-10: Simple</span>
              </div>
              <div class="flex items-center justify-center gap-2">
                <span class="w-2 h-2 bg-yellow-500 rounded-full"></span><span>11-20: Moderado</span>
              </div>
              <div class="flex items-center justify-center gap-2">
                <span class="w-2 h-2 bg-red-500 rounded-full"></span><span>>20: Complejo</span>
              </div>
            </div>
          </div>
        </div>

        <!-- IVC -->
        <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100">
          <div class="flex items-center justify-between mb-4 border-b pb-3">
            <div class="flex items-center gap-3">
              <div class="bg-red-100 p-2 rounded-lg"><i class="fas fa-shield-alt text-red-600"></i></div>
              <h3 class="text-lg font-bold text-slate-700">√çndice Vulnerabilidad (IVC)</h3>
            </div>
            <div class="tooltip">
              <i class="fas fa-question-circle text-red-400 help-icon"></i>
              <span class="tooltiptext">
                <strong>¬øQu√© es IVC?</strong><br>
                √çndice de Vulnerabilidad Cr√≠tica. Mide qu√© porcentaje de las vulnerabilidades encontradas son de alta gravedad y necesitan correcci√≥n urgente.
              </span>
            </div>
          </div>

          <div class="bg-red-50 border-l-4 border-red-500 p-3 mb-4 rounded-r-lg">
            <p class="text-xs text-red-900 mb-2"><strong>üîí ¬øPor qu√© importa?</strong></p>
            <p class="text-xs text-red-800">Las vulnerabilidades cr√≠ticas (SQLi, XSS, RCE) pueden comprometer completamente tu sistema. Este √≠ndice te ayuda a priorizar las correcciones.</p>
          </div>

          <div class="mb-4 text-xs bg-slate-100 p-2 rounded font-mono text-slate-600">IVC = (Cr√≠ticas / Totales) √ó 100%</div>

          <div class="space-y-3 mb-4">
            <div class="input-group">
              <label class="text-xs font-bold text-slate-500 flex items-center gap-1">
                Total Vulnerabilidades
                <div class="tooltip">
                  <i class="fas fa-info-circle text-red-400 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 220px; margin-left: -110px;">
                    Todas las vulnerabilidades detectadas por herramientas de seguridad (OWASP ZAP, SonarQube, etc.), incluyendo bajas, medias y cr√≠ticas.
                  </span>
                </div>
              </label>
              <input type="number" id="ivc-total" class="w-full p-2 border-2 border-slate-300 rounded-md focus:border-red-500" placeholder="14">
              <p class="text-[10px] text-slate-400 mt-1">Ejemplo: 14 issues encontrados en total</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>
            <div class="input-group">
              <label class="text-xs font-bold text-slate-500 flex items-center gap-1">
                Cr√≠ticas (SQLi, XSS, RCE)
                <div class="tooltip">
                  <i class="fas fa-info-circle text-red-400 text-[10px]"></i>
                  <span class="tooltiptext" style="width: 220px; margin-left: -110px;">
                    Solo las vulnerabilidades de alta gravedad: SQL Injection, Cross-Site Scripting, Remote Code Execution, etc. Son las m√°s peligrosas.
                  </span>
                </div>
              </label>
              <input type="number" id="ivc-critical" class="w-full p-2 border-2 border-slate-300 rounded-md focus:border-red-500" placeholder="2">
              <p class="text-[10px] text-slate-400 mt-1">Ejemplo: 2 vulnerabilidades de severidad alta/cr√≠tica</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>
          </div>

          <button onclick="calcIVC()"
            class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg transition-colors flex items-center justify-center gap-2">
            <i class="fas fa-bug"></i>
            Calcular Seguridad
          </button>

          <div id="ivc-result" class="hidden mt-4 pt-4 border-t text-center">
            <i class="fas fa-shield-alt text-2xl text-red-500 mb-2"></i>
            <span class="text-4xl font-bold text-slate-700 block" id="ivc-value">0%</span>
            <span id="ivc-badge" class="inline-block mt-2 px-4 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-bold">--</span>
            <div class="mt-3 text-[10px] text-slate-500 space-y-1">
              <div class="flex items-center justify-center gap-2">
                <span class="w-2 h-2 bg-green-500 rounded-full"></span><span>0%: Seguro</span>
              </div>
              <div class="flex items-center justify-center gap-2">
                <span class="w-2 h-2 bg-yellow-500 rounded-full"></span><span>1-15%: Vulnerable</span>
              </div>
              <div class="flex items-center justify-center gap-2">
                <span class="w-2 h-2 bg-red-500 rounded-full"></span><span>>15%: Inseguro</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- UX -->
    <section id="usability" class="content-section hidden space-y-6">
      <div class="bg-white rounded-2xl shadow-md p-8 border border-slate-100 max-w-3xl mx-auto">
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center">
            <div class="bg-teal-100 p-3 rounded-full text-teal-600 mr-4"><i class="fas fa-users text-xl"></i></div>
            <div>
              <h2 class="text-xl font-bold text-slate-800">Usabilidad (ISO 9241)</h2>
              <p class="text-slate-500 text-sm">Tasa de √©xito en tareas de usuario</p>
            </div>
          </div>
          <div class="tooltip">
            <i class="fas fa-question-circle text-2xl text-teal-400 help-icon"></i>
            <span class="tooltiptext">
              <strong>¬øQu√© es Usabilidad?</strong><br>
              Mide qu√© tan f√°cil es para los usuarios completar tareas en tu aplicaci√≥n. Una buena usabilidad significa una mejor experiencia de usuario.
            </span>
          </div>
        </div>

        <!-- Info Box -->
        <div class="info-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <div class="flex items-start gap-3">
            <i class="fas fa-smile text-2xl mt-1"></i>
            <div>
              <strong class="block mb-1">¬øC√≥mo se mide la usabilidad?</strong>
              Define tareas espec√≠ficas (ej: "registrarse", "buscar producto", "realizar pago") y observa cu√°ntos usuarios las completan exitosamente. 
              Una tasa >90% indica que tu interfaz es intuitiva y f√°cil de usar.
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 my-6">
          <div>
            <div class="step-indicator mb-3">
              <div class="step-number">1</div>
              <span class="text-sm font-semibold text-slate-700">Define las tareas a evaluar</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Tareas Totales
                <div class="tooltip">
                  <i class="fas fa-info-circle text-teal-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero total de tareas que los usuarios intentaron realizar durante las pruebas. Ejemplo: si 10 usuarios probaron 4 tareas cada uno, ser√≠an 40 intentos totales.
                  </span>
                </div>
              </label>
              <input type="number" id="ux-total" class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg focus:border-teal-500 focus:ring-2 focus:ring-teal-200"
                placeholder="40">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-tasks mr-1"></i>Total de intentos de tarea</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>
          </div>

          <div>
            <div class="step-indicator mb-3">
              <div class="step-number">2</div>
              <span class="text-sm font-semibold text-slate-700">Cuenta las completadas con √©xito</span>
            </div>
            <div class="input-group">
              <label class="block text-sm font-semibold text-slate-600 mb-1 flex items-center gap-2">
                Tareas Exitosas
                <div class="tooltip">
                  <i class="fas fa-info-circle text-teal-400 text-xs"></i>
                  <span class="tooltiptext">
                    N√∫mero de tareas completadas sin ayuda y sin errores. Solo cuenta como exitosa si el usuario logr√≥ el objetivo sin frustrarse o abandonar.
                  </span>
                </div>
              </label>
              <input type="number" id="ux-success" class="w-full p-3 bg-slate-50 border-2 border-slate-300 rounded-lg focus:border-teal-500 focus:ring-2 focus:ring-teal-200"
                placeholder="35">
              <p class="text-xs text-slate-400 mt-1"><i class="fas fa-check-circle mr-1"></i>Completadas sin problemas</p>
              <p class="hidden text-red-500 text-xs mt-1 error-msg"></p>
            </div>
          </div>
        </div>

        <div class="step-indicator mb-3">
          <div class="step-number">3</div>
          <span class="text-sm font-semibold text-slate-700">Obt√©n la tasa de √©xito</span>
        </div>
        <button onclick="calcUX()"
          class="w-full bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
          <i class="fas fa-user-check"></i>
          Calcular Tasa de √âxito
        </button>

        <div id="ux-result" class="hidden mt-8 bg-gradient-to-br from-slate-50 to-teal-50 rounded-xl p-8 border-2 border-teal-200 text-center shadow-lg">
          <i class="fas fa-smile-beam text-4xl text-teal-500 mb-3"></i>
          <span class="text-slate-500 text-sm uppercase font-semibold block mb-2">Tasa de √âxito en Usabilidad</span>
          <div class="text-6xl font-extrabold text-slate-800 mb-3" id="ux-value">0%</div>
          <div id="ux-badge" class="inline-block px-6 py-2 rounded-full text-sm font-bold bg-gray-100 text-gray-700 shadow-md">--</div>
          
          <div class="mt-6 pt-6 border-t border-slate-300">
            <p class="text-xs font-bold text-slate-600 uppercase mb-2">üòä Niveles de usabilidad:</p>
            <div class="text-xs text-left space-y-1 text-slate-600 max-w-md mx-auto">
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                <span><strong>> 90%:</strong> Excelente - Interfaz intuitiva y f√°cil de usar</span>
              </div>
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                <span><strong>70-90%:</strong> Aceptable - Hay aspectos mejorables</span>
              </div>
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                <span><strong>< 70%:</strong> Problema - Redise√±ar la experiencia de usuario</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <script>
    // --- EVENT LOG SYSTEM ---
    let eventLog = [];
    let calculatedMetrics = new Set();
    let metricsData = {};

    function addEvent(type, metric, value, status) {
      const event = {
        timestamp: new Date().toLocaleString('es-ES'),
        type: type,
        metric: metric,
        value: value,
        status: status
      };
      eventLog.unshift(event); // Add to beginning
      
      // Agregar al conjunto de m√©tricas calculadas y actualizar progreso
      calculatedMetrics.add(metric);
      updateProgress();
      
      // Guardar datos para el reporte PDF
      metricsData[metric] = value;
      
      updateEventLogDisplay();
    }
    
    // Funci√≥n para actualizar el progreso
    function updateProgress() {
      const total = 7;
      const calculated = calculatedMetrics.size;
      const percentage = (calculated / total) * 100;
      
      document.getElementById('progressCount').textContent = calculated;
      document.getElementById('progressBar').style.width = percentage + '%';
    }

    function updateEventLogDisplay() {
      const logContainer = document.getElementById('event-log');
      if (eventLog.length === 0) {
        logContainer.innerHTML = '<p class="text-xs text-slate-400 text-center py-4">No hay eventos registrados a√∫n</p>';
        return;
      }

      let html = '<div class="space-y-2">';
      eventLog.slice(0, 10).forEach(event => { // Show last 10
        const statusColors = {
          'success': 'bg-green-500/20 border-green-500 text-green-200',
          'warning': 'bg-yellow-500/20 border-yellow-500 text-yellow-200',
          'error': 'bg-red-500/20 border-red-500 text-red-200',
          'info': 'bg-blue-500/20 border-blue-500 text-blue-200'
        };
        const statusIcons = {
          'success': 'fa-check-circle',
          'warning': 'fa-exclamation-triangle',
          'error': 'fa-times-circle',
          'info': 'fa-info-circle'
        };
        
        html += `
          <div class="border-l-2 ${statusColors[event.status] || statusColors.info} p-2 rounded text-xs">
            <div class="flex items-start gap-2">
              <i class="fas ${statusIcons[event.status] || statusIcons.info} mt-0.5 text-[10px]"></i>
              <div class="flex-1">
                <div class="font-semibold">${event.metric}</div>
                <div class="text-[10px] opacity-80">${event.value} - ${event.timestamp}</div>
              </div>
            </div>
          </div>
        `;
      });
      html += '</div>';
      logContainer.innerHTML = html;
    }

    function clearEventLog() {
      if (confirm('¬øEst√°s seguro de que deseas limpiar todo el historial? Esta acci√≥n no se puede deshacer.')) {
        eventLog = [];
        calculatedMetrics.clear();
        metricsData = {};
        updateProgress();
        updateEventLogDisplay();
      }
    }

    function exportToCSV() {
      if (eventLog.length === 0) {
        alert('No hay datos para exportar. Realiza algunos c√°lculos primero.');
        return;
      }

      // Create CSV content
      let csv = 'Fecha y Hora,Tipo,M√©trica,Valor,Estado\n';
      eventLog.forEach(event => {
        csv += `"${event.timestamp}","${event.type}","${event.metric}","${event.value}","${event.status}"\n`;
      });

      // Create download link
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `reporte_calidad_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // --- Funci√≥n de generaci√≥n de PDF ---
    async function generatePDFReport() {
      if (calculatedMetrics.size === 0) {
        alert('‚ö†Ô∏è No hay c√°lculos disponibles. Por favor, calcula al menos una m√©trica antes de generar el reporte.');
        return;
      }
      
      const projectName = document.getElementById('projectName').value || 'Mi Proyecto de Calidad';
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('p', 'mm', 'a4');
      
      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      let yPos = 20;
      
      // === PORTADA ===
      pdf.setFillColor(99, 102, 241); // Indigo
      pdf.rect(0, 0, pageWidth, 60, 'F');
      
      pdf.setTextColor(255, 255, 255);
      pdf.setFontSize(28);
      pdf.setFont(undefined, 'bold');
      pdf.text('REPORTE DE CALIDAD', pageWidth / 2, 30, { align: 'center' });
      
      pdf.setFontSize(16);
      pdf.setFont(undefined, 'normal');
      pdf.text('SOFTWARE', pageWidth / 2, 45, { align: 'center' });
      
      yPos = 80;
      pdf.setTextColor(0, 0, 0);
      
      // === INFORMACI√ìN DEL PROYECTO ===
      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.text('Proyecto:', 20, yPos);
      pdf.setFont(undefined, 'normal');
      pdf.setFontSize(12);
      pdf.text(projectName, 45, yPos);
      
      yPos += 10;
      pdf.setFontSize(10);
      pdf.text('Fecha: ' + new Date().toLocaleDateString('es-ES'), 20, yPos);
      pdf.text('Hora: ' + new Date().toLocaleTimeString('es-ES'), 80, yPos);
      
      yPos += 8;
      pdf.text('Materia: 27888 Aseguramiento de la Calidad de Software', 20, yPos);
      pdf.text('Estudiante: Yeshua Chiliquinga', 20, yPos + 6);
      
      yPos += 18;
      
      // L√≠nea divisoria
      pdf.setDrawColor(200, 200, 200);
      pdf.line(20, yPos, pageWidth - 20, yPos);
      yPos += 10;
      
      // === RESUMEN EJECUTIVO ===
      pdf.setFillColor(240, 240, 255);
      pdf.rect(15, yPos - 5, pageWidth - 30, 8, 'F');
      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.setTextColor(99, 102, 241);
      pdf.text('RESUMEN EJECUTIVO', 20, yPos);
      yPos += 12;
      
      pdf.setTextColor(0, 0, 0);
      pdf.setFontSize(10);
      pdf.setFont(undefined, 'normal');
      
      const summary = `Este reporte presenta los resultados del an√°lisis de calidad realizado sobre el proyecto "${projectName}". Se han evaluado ${calculatedMetrics.size} de 7 m√©tricas disponibles, incluyendo aspectos de calidad de proceso y producto seg√∫n est√°ndares ISO 29110 e ISO 9001, as√≠ como m√©tricas de fiabilidad, rendimiento, calidad estructural y usabilidad.`;
      
      const summaryLines = pdf.splitTextToSize(summary, pageWidth - 40);
      pdf.text(summaryLines, 20, yPos);
      yPos += summaryLines.length * 5 + 10;
      
      // === M√âTRICAS CALCULADAS ===
      pdf.setFillColor(240, 240, 255);
      pdf.rect(15, yPos - 5, pageWidth - 30, 8, 'F');
      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.setTextColor(99, 102, 241);
      pdf.text('M√âTRICAS CALCULADAS', 20, yPos);
      yPos += 12;
      
      pdf.setTextColor(0, 0, 0);
      pdf.setFontSize(10);
      
      // Obtener valores actuales del dashboard
      const metrics = [
        { key: 'ICP', name: '√çndice de Cumplimiento de Procesos (ICP)', desc: 'ISO 29110', id: 'dash-icp' },
        { key: 'NC', name: 'Nivel de No Conformidades (NC)', desc: 'ISO 9001', id: 'dash-nc' },
        { key: 'MTBF', name: 'Tiempo Medio Entre Fallos (MTBF)', desc: 'Fiabilidad', id: 'dash-mtbf' },
        { key: 'TPR', name: 'Tasa de Procesamiento (TPR)', desc: 'Rendimiento', id: 'dash-tpr' },
        { key: 'CC', name: 'Complejidad Ciclom√°tica (CC)', desc: 'Calidad Estructural', id: 'dash-cc' },
        { key: 'IVC', name: '√çndice de Vulnerabilidades Cr√≠ticas', desc: 'Seguridad', id: 'dash-ivc' },
        { key: 'UX', name: '√çndice de Usabilidad (UX)', desc: 'Experiencia de Usuario', id: 'dash-ux' }
      ];
      
      for (const metric of metrics) {
        if (yPos > pageHeight - 30) {
          pdf.addPage();
          yPos = 20;
        }
        
        const element = document.getElementById(metric.id);
        if (element && element.textContent !== '--%' && element.textContent !== '--') {
          const value = element.textContent;
          
          // Fondo de m√©trica
          pdf.setFillColor(250, 250, 250);
          pdf.rect(18, yPos - 4, pageWidth - 36, 18, 'F');
          pdf.setDrawColor(220, 220, 220);
          pdf.rect(18, yPos - 4, pageWidth - 36, 18, 'S');
          
          pdf.setFont(undefined, 'bold');
          pdf.setFontSize(11);
          pdf.text(metric.name, 22, yPos);
          
          pdf.setFont(undefined, 'normal');
          pdf.setFontSize(9);
          pdf.setTextColor(100, 100, 100);
          pdf.text(metric.desc, 22, yPos + 5);
          
          pdf.setFont(undefined, 'bold');
          pdf.setFontSize(14);
          pdf.setTextColor(34, 197, 94); // Verde
          pdf.text(String(value), pageWidth - 35, yPos + 3);
          
          pdf.setTextColor(0, 0, 0);
          yPos += 22;
        }
      }
      
      yPos += 5;
      
      // === REGISTRO DE EVENTOS ===
      if (eventLog.length > 0) {
        pdf.addPage();
        yPos = 20;
        
        pdf.setFillColor(240, 240, 255);
        pdf.rect(15, yPos - 5, pageWidth - 30, 8, 'F');
        pdf.setFontSize(14);
        pdf.setFont(undefined, 'bold');
        pdf.setTextColor(99, 102, 241);
        pdf.text('REGISTRO DE EVENTOS', 20, yPos);
        yPos += 12;
        
        pdf.setTextColor(0, 0, 0);
        pdf.setFontSize(9);
        pdf.setFont(undefined, 'bold');
        
        // Encabezados de tabla
        pdf.text('Fecha/Hora', 20, yPos);
        pdf.text('M√©trica', 65, yPos);
        pdf.text('Valor', 130, yPos);
        pdf.text('Estado', 160, yPos);
        yPos += 5;
        
        pdf.setDrawColor(200, 200, 200);
        pdf.line(20, yPos, pageWidth - 20, yPos);
        yPos += 5;
        
        pdf.setFont(undefined, 'normal');
        
        eventLog.slice(0, 30).forEach(event => {
          if (yPos > pageHeight - 20) {
            pdf.addPage();
            yPos = 20;
          }
          
          const timeText = event.timestamp.length > 17 ? event.timestamp.substring(11) : event.timestamp;
          pdf.text(timeText, 20, yPos);
          
          const metricText = event.metric.length > 20 ? event.metric.substring(0, 20) + '...' : event.metric;
          pdf.text(metricText, 65, yPos);
          
          pdf.text(String(event.value), 130, yPos);
          pdf.text(event.status === 'success' ? 'OK' : 'Error', 160, yPos);
          yPos += 6;
        });
      }
      
      // === PIE DE P√ÅGINA ===
      const totalPages = pdf.internal.getNumberOfPages();
      for (let i = 1; i <= totalPages; i++) {
        pdf.setPage(i);
        pdf.setFontSize(8);
        pdf.setTextColor(150, 150, 150);
        pdf.text(`P√°gina ${i} de ${totalPages}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
        pdf.text('Generado por Sistema de M√©tricas de Calidad Software', pageWidth / 2, pageHeight - 5, { align: 'center' });
      }
      
      // Descargar PDF
      const fileName = `Reporte_Calidad_${projectName.replace(/[^a-z0-9]/gi, '_')}_${new Date().getTime()}.pdf`;
      pdf.save(fileName);
      
      logEvent('Reporte PDF Generado', fileName, 'export', 'success');
      alert('‚úÖ Reporte PDF generado exitosamente: ' + fileName);
    }

    // --- Navigation ---
    function showSection(sectionId) {
      document.querySelectorAll('.content-section').forEach(sec => sec.classList.add('hidden'));
      document.getElementById(sectionId).classList.remove('hidden');

      // Sidebar Active State
      document.querySelectorAll('.sidebar-link').forEach(link => link.classList.remove('active', 'border-l-4', 'border-indigo-500'));
      document.getElementById('nav-' + sectionId).classList.add('active');

      // Dynamic Title & Subtitle
      const titles = {
        'dashboard': 'Panel de Control',
        'iso29110': 'Gesti√≥n VSE (ISO 29110)',
        'iso9001': 'Auditor√≠a (ISO 9001)',
        'reliability': 'Fiabilidad (ISO 25010)',
        'performance': 'Rendimiento',
        'structure': 'Calidad Estructural',
        'usability': 'Usabilidad'
      };
      const subtitles = {
        'dashboard': 'Sistema de gesti√≥n y monitorizaci√≥n de m√©tricas de calidad de software',
        'iso29110': '√çndice de Cumplimiento de Procesos para Microempresas',
        'iso9001': 'Evaluaci√≥n de No Conformidades en Auditor√≠as',
        'reliability': 'An√°lisis del Tiempo Medio Entre Fallos',
        'performance': 'Medici√≥n de Tiempos de Respuesta',
        'structure': 'An√°lisis de Complejidad y Vulnerabilidades',
        'usability': 'Evaluaci√≥n de Experiencia de Usuario'
      };
      document.getElementById('page-title').innerText = titles[sectionId] || 'Sistema de Calidad';
      document.getElementById('page-subtitle').innerText = subtitles[sectionId] || 'Sistema de gesti√≥n de calidad';
    }

    // --- VALIDATION HELPER ---
    function validateInput(inputElement, conditionFn, errorMsg) {
      const val = parseFloat(inputElement.value);
      const parent = inputElement.parentElement;
      const errorP = parent.querySelector('.error-msg');

      // Reset previous error
      inputElement.classList.remove('border-red-500', 'shake');
      if (errorP) errorP.classList.add('hidden');

      // Check Empty
      if (isNaN(val) && inputElement.value === "") {
        showError(inputElement, errorP, "Este campo es obligatorio.");
        return null;
      }

      // Custom Condition
      if (!conditionFn(val)) {
        showError(inputElement, errorP, errorMsg);
        return null;
      }
      return val;
    }

    function showError(input, errorElement, msg) {
      input.classList.add('border-red-500', 'shake');
      if (errorElement) {
        errorElement.innerText = msg;
        errorElement.classList.remove('hidden');
      }
      setTimeout(() => input.classList.remove('shake'), 820);
    }

    // --- UI HELPERS ---
    function updateBadge(id, text, type, barId) {
      const el = document.getElementById(id);
      const bar = document.getElementById(barId);
      el.innerText = text;

      let colorClass = "bg-gray-200 text-gray-700";
      let barColor = "bg-gray-300";

      if (type === 'good') {
        colorClass = "bg-green-100 text-green-700";
        barColor = "bg-green-500";
      } else if (type === 'warning') {
        colorClass = "bg-yellow-100 text-yellow-800";
        barColor = "bg-yellow-500";
      } else if (type === 'bad') {
        colorClass = "bg-red-100 text-red-700";
        barColor = "bg-red-500";
      }

      el.className = `px-4 py-1 rounded-full text-sm font-bold ${colorClass}`;
      if (bar) bar.className = `absolute top-0 left-0 w-2 h-full ${barColor}`;
    }

    // --- CALCULATORS ---

    // 1. ICP
    function calcICP() {
      const planned = validateInput(document.getElementById('icp-planned'), v => v > 0, "Debe ser mayor a 0.");
      const realized = validateInput(document.getElementById('icp-realized'), v => v >= 0, "No puede ser negativo.");

      if (planned === null || realized === null) return;

      if (realized > planned) {
        // Warning logic purely for validation, though mathematically possible (extra work)
        // We allow it but maybe warn? For now let's pass.
      }

      const icp = (realized / planned) * 100;
      const finalVal = icp.toFixed(1) + '%';

      document.getElementById('icp-value').innerText = finalVal;
      document.getElementById('icp-result').classList.remove('hidden');
      document.getElementById('dash-icp').innerText = finalVal;

      let type = 'bad';
      let msg = "Proceso indisciplinado.";
      if (icp >= 85) { type = 'good'; msg = "¬°Excelente disciplina!"; }
      else if (icp >= 70) { type = 'warning'; msg = "Desviaci√≥n aceptable."; }

      updateBadge('icp-badge', type === 'good' ? 'OPTIMIZADO' : (type === 'warning' ? 'ACEPTABLE' : 'BAJO'), type, 'icp-bar');
      document.getElementById('icp-feedback').innerText = msg;
      updateChartData(0, icp);
      
      // Log event
      addEvent('C√°lculo', 'ISO 29110 (ICP)', finalVal, type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // 2. NC
    function calcNC() {
      const total = validateInput(document.getElementById('nc-total'), v => v > 0, "Debe haber al menos 1 proceso.");
      const found = validateInput(document.getElementById('nc-found'), v => v >= 0, "No puede ser negativo.");

      if (total === null || found === null) return;

      const nc = found / total;
      const ncDisplay = nc.toFixed(2);
      document.getElementById('nc-value').innerText = ncDisplay;
      document.getElementById('nc-result').classList.remove('hidden');
      document.getElementById('dash-nc').innerText = ncDisplay;

      let type = 'bad';
      if (nc === 0) type = 'good';
      else if (nc < 0.25) type = 'warning';

      updateBadge('nc-badge', type === 'good' ? 'PERFECTO' : (type === 'warning' ? 'GESTIONABLE' : 'FALLIDO'), type, 'nc-bar');
      
      // Log event
      addEvent('C√°lculo', 'ISO 9001 (NC)', ncDisplay, type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // 3. MTBF
    function calcMTBF() {
      const time = validateInput(document.getElementById('mtbf-time'), v => v > 0, "El tiempo debe ser positivo.");
      const fails = validateInput(document.getElementById('mtbf-fails'), v => v >= 0, "No negativo.");

      if (time === null || fails === null) return;

      let mtbf = 0;
      let display = "";
      let type = 'bad';

      if (fails === 0) {
        display = "‚àû";
        type = 'good';
        mtbf = 999; // For chart
      } else {
        mtbf = time / fails;
        display = mtbf.toFixed(1) + "h";

        if (mtbf > 72) type = 'good';
        else if (mtbf > 24) type = 'warning';
      }

      document.getElementById('mtbf-value').innerText = display;
      document.getElementById('mtbf-result').classList.remove('hidden');
      document.getElementById('dash-mtbf').innerText = display;

      updateBadge('mtbf-badge', type === 'good' ? 'ESTABLE' : (type === 'warning' ? 'ALERTA' : 'CR√çTICO'), type, 'mtbf-bar');
      updateChartData(1, Math.min(mtbf, 100)); // Cap for radar
      
      // Log event
      addEvent('C√°lculo', 'Fiabilidad (MTBF)', display, type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // 4. TPR
    function calcTPR() {
      const total = validateInput(document.getElementById('tpr-total-time'), v => v > 0, "Tiempo > 0");
      const reqs = validateInput(document.getElementById('tpr-requests'), v => v > 0, "Solicitudes > 0");

      if (total === null || reqs === null) return;

      const tpr = total / reqs;
      document.getElementById('tpr-value').innerText = tpr.toFixed(0) + "ms";
      document.getElementById('tpr-result').classList.remove('hidden');
      document.getElementById('dash-tpr').innerText = tpr.toFixed(0) + " ms";

      let type = 'bad';
      if (tpr < 200) type = 'good';
      else if (tpr < 1000) type = 'warning';

      updateBadge('tpr-badge', type === 'good' ? 'EXCELENTE' : (type === 'warning' ? 'NORMAL' : 'LENTO'), type, 'tpr-bar');

      // Inverse for chart (Lower is better)
      let chartVal = 100;
      if (tpr > 1000) chartVal = 20;
      else if (tpr > 200) chartVal = 60;
      updateChartData(2, chartVal);
      
      // Log event
      addEvent('C√°lculo', 'Rendimiento (TPR)', tpr.toFixed(0) + 'ms', type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // 5. CC
    function calcCC() {
      const e = parseFloat(document.getElementById('cc-edges').value) || 0;
      const n = parseFloat(document.getElementById('cc-nodes').value) || 0;
      const p = parseFloat(document.getElementById('cc-comp').value) || 1;
      const errorP = document.getElementById('cc-error');

      if (n === 0 && e === 0) {
        errorP.innerText = "Ingresa nodos o aristas.";
        errorP.classList.remove('hidden');
        return;
      }
      errorP.classList.add('hidden');

      const cc = e - n + (2 * p);
      document.getElementById('cc-value').innerText = cc;
      document.getElementById('cc-result').classList.remove('hidden');
      document.getElementById('dash-cc').innerText = cc;

      let type = 'bad';
      let txt = 'COMPLEJO';
      if (cc <= 10) { type = 'good'; txt = 'SIMPLE'; }
      else if (cc <= 20) { type = 'warning'; txt = 'MODERADO'; }

      const badge = document.getElementById('cc-badge');
      badge.innerText = txt;
      badge.className = type === 'good' ? "inline-block mt-1 px-3 py-1 bg-green-100 text-green-700 rounded text-xs font-bold" :
        (type === 'warning' ? "inline-block mt-1 px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-xs font-bold" :
          "inline-block mt-1 px-3 py-1 bg-red-100 text-red-700 rounded text-xs font-bold");

      // Update dashboard
      document.getElementById('dash-cc').innerText = cc.toString();
      
      // Chart (Inverse: lower is better)
      let chartScore = Math.max(0, 100 - (cc * 2));
      updateChartData(3, chartScore);
      
      // Log event
      addEvent('C√°lculo', 'Complejidad Ciclom√°tica', cc.toString(), type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // 6. IVC
    function calcIVC() {
      const total = validateInput(document.getElementById('ivc-total'), v => v > 0, "Total > 0");
      const crit = validateInput(document.getElementById('ivc-critical'), v => v >= 0, ">= 0");

      if (total === null || crit === null) return;
      if (crit > total) {
        showError(document.getElementById('ivc-critical'), null, "Cr√≠ticas no pueden ser mayor al total.");
        alert("Error: Las cr√≠ticas no pueden superar al total.");
        return;
      }

      const ivc = (crit / total) * 100;
      document.getElementById('ivc-value').innerText = ivc.toFixed(1) + "%";
      document.getElementById('ivc-result').classList.remove('hidden');

      let type = 'bad';
      let txt = 'INSEGURO';
      if (ivc === 0) { type = 'good'; txt = 'SEGURO'; }
      else if (ivc < 15) { type = 'warning'; txt = 'VULNERABLE'; }

      const badge = document.getElementById('ivc-badge');
      badge.innerText = txt;
      badge.className = type === 'good' ? "inline-block mt-1 px-3 py-1 bg-green-100 text-green-700 rounded text-xs font-bold" :
        (type === 'warning' ? "inline-block mt-1 px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-xs font-bold" :
          "inline-block mt-1 px-3 py-1 bg-red-100 text-red-700 rounded text-xs font-bold");
      
      // Update dashboard
      document.getElementById('dash-ivc').innerText = ivc.toFixed(1) + '%';
      
      // Log event
      addEvent('C√°lculo', '√çndice Vulnerabilidad', ivc.toFixed(1) + '%', type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // 7. UX
    function calcUX() {
      const total = validateInput(document.getElementById('ux-total'), v => v > 0, "> 0");
      const success = validateInput(document.getElementById('ux-success'), v => v >= 0, ">= 0");

      if (total === null || success === null) return;
      if (success > total) {
        alert("Erro: √âxitos > Totales");
        return;
      }

      const rate = (success / total) * 100;
      document.getElementById('ux-value').innerText = rate.toFixed(1) + "%";
      document.getElementById('ux-result').classList.remove('hidden');

      let type = 'bad';
      let txt = 'BAJO';
      if (rate > 90) { type = 'good'; txt = 'INTUITIVO'; }
      else if (rate > 70) { type = 'warning'; txt = 'MEJORABLE'; }

      const badge = document.getElementById('ux-badge');
      badge.innerText = txt;
      badge.className = type === 'good' ? "mt-2 inline-block px-4 py-1 rounded-full text-sm font-bold bg-green-100 text-green-700" :
        (type === 'warning' ? "mt-2 inline-block px-4 py-1 rounded-full text-sm font-bold bg-yellow-100 text-yellow-800" :
          "mt-2 inline-block px-4 py-1 rounded-full text-sm font-bold bg-red-100 text-red-700");

      // Update dashboard
      document.getElementById('dash-ux').innerText = rate.toFixed(1) + '%';
      
      updateChartData(4, rate);
      
      // Log event
      addEvent('C√°lculo', 'Usabilidad (UX)', rate.toFixed(1) + '%', type === 'good' ? 'success' : (type === 'warning' ? 'warning' : 'error'));
    }

    // --- SISTEMA DE TOOLTIPS INTELIGENTE ---
    document.addEventListener('DOMContentLoaded', function() {
      const tooltips = document.querySelectorAll('.tooltip');
      
      tooltips.forEach(tooltip => {
        const tooltipText = tooltip.querySelector('.tooltiptext');
        if (!tooltipText) return;
        
        tooltip.addEventListener('mouseenter', function(e) {
          const rect = tooltip.getBoundingClientRect();
          const tooltipRect = tooltipText.getBoundingClientRect();
          
          // Calcular espacio disponible
          const spaceAbove = rect.top;
          const spaceBelow = window.innerHeight - rect.bottom;
          const spaceLeft = rect.left;
          const spaceRight = window.innerWidth - rect.right;
          
          // Determinar la mejor posici√≥n
          let position = 'top';
          
          // Si no hay espacio arriba, mostrar abajo
          if (spaceAbove < 150 && spaceBelow > 150) {
            position = 'bottom';
            tooltipText.style.top = (rect.bottom + 10) + 'px';
          } 
          // Si hay espacio arriba, mostrar arriba
          else if (spaceAbove > 150) {
            position = 'top';
            tooltipText.style.top = (rect.top - 10) + 'px';
            tooltipText.style.transform = 'translateY(-100%)';
          }
          // Si no hay espacio ni arriba ni abajo, mostrar al lado
          else if (spaceRight > 300) {
            position = 'right';
            tooltipText.style.top = rect.top + 'px';
            tooltipText.style.left = (rect.right + 10) + 'px';
            tooltipText.style.transform = 'translateY(-50%)';
          } else if (spaceLeft > 300) {
            position = 'left';
            tooltipText.style.top = rect.top + 'px';
            tooltipText.style.left = (rect.left - 10) + 'px';
            tooltipText.style.transform = 'translate(-100%, -50%)';
          }
          
          // Centrar horizontalmente si es top o bottom
          if (position === 'top' || position === 'bottom') {
            const tooltipWidth = 280;
            let leftPos = rect.left + (rect.width / 2) - (tooltipWidth / 2);
            
            // Ajustar si se sale por la izquierda
            if (leftPos < 10) leftPos = 10;
            
            // Ajustar si se sale por la derecha
            if (leftPos + tooltipWidth > window.innerWidth - 10) {
              leftPos = window.innerWidth - tooltipWidth - 10;
            }
            
            tooltipText.style.left = leftPos + 'px';
          }
          
          tooltipText.setAttribute('data-position', position);
        });
      });
    });

    // --- CHART ---
    let qualityChart;
    function initChart() {
      const ctx = document.getElementById('qualityChart').getContext('2d');
      qualityChart = new Chart(ctx, {
        type: 'radar',
        data: {
          labels: ['Proceso (ICP)', 'Fiabilidad', 'Rendimiento', 'Mantenibilidad', 'Usabilidad'],
          datasets: [{
            label: 'Nivel de Calidad (0-100)',
            data: [20, 20, 20, 20, 20], // Default small shape
            backgroundColor: 'rgba(99, 102, 241, 0.2)', // Indigo
            borderColor: 'rgba(99, 102, 241, 1)',
            pointBackgroundColor: '#fff',
            pointBorderColor: '#4f46e5',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              angleLines: { color: '#e2e8f0' },
              grid: { color: '#e2e8f0' },
              pointLabels: {
                font: { size: 11, family: 'Inter' },
                color: '#64748b'
              },
              suggestedMin: 0,
              suggestedMax: 100
            }
          },
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    function updateChartData(index, value) {
      if (qualityChart) {
        qualityChart.data.datasets[0].data[index] = value;
        qualityChart.update();
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      initChart();
      if (window.MathJax) MathJax.typeset();
    });

  </script>
</body>

</html>